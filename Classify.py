# from pathlib import Path
# import pandas as pd

# # 1. المجموعات وقواعد التصنيف
# # ==============================================================================

# # تعريف المجموعات (اسم رمزي إنجليزي وقائمة بالكلمات التابعة له)
# groups = [
#     ("jar", [
#         "ب", "ت", "ك", "عن", "في", "مذ", "منذ", "ل", "من", "إلى", "على", "رب", "حتى",
#         "خلا", "عدا", "حاشا", "كي", "لعل", "متى", "لولا",
#         "منه","منها","منهما","منهم","منهن","عنه","عنها","عنهما","عنهم","عنهن",
#         "إليه","إليها","إليهما","إليهن","عليه","عليهما","عليها","عليهم","عليهن",
#         "فيه","فيها","فيهما","فيهم","فيهن","له","لها","لهما","لهم","لهن",
#         "به","بها","بهما","بهم","بهن",
#         "منك","منكما","منكم","منكن","عنك","عنكما","عنكن","عنكم",
#         "إليك","إليكما","إليكم","إليكن","عليك","عليكما","عليكم","عليكن",
#         "فيك","فيكما","فيكم","فيكن","لك","لكما","لكم","لكن","بك","بكما","بكم","بكن",
#         "منا","عنا","إلينا","علينا","فينا","بنا","لنا","مني","عني","علي","إلي","لي","بي",
#         "ومن","فمن","لمن","كمن"
#     ]),
#     ("al_jawab", ["نعم", "بلى", "أجل", "إن", "أي", "أوى", "أفي", "نعما", "كلا", "بجل"]),
#     ("istifham", ["من", "من ذا", "ما", "ماذا", "متى", "أيان", "أين", "أنى", "كم", "كيف", "أ", "أأ", "فيم","عم","مم","بم","لم","إلام","حتام","علام", "هل"]),
#     ("jazm", ["لم", "لما", "لا", "ل", "إن", "إنما", "من", "ما", "مهما", "متى", "أيان", "أين", "حيثما", "أنى", "اذما"]),
#     ("shart", ["من", "إن", "أين", "أينما", "كيفما", "متى", "حيثما", "أنى", "أيان", "ما", "مهما", "اذما", "لو", "إذا"]),
#     ("nidaa", ["يا", "أيا", "هيا", "أي", "آي", "أيها", "وا", "آ", "أ"]),
#     ("ishara", ["هذا", "هذه", "هذي", "هاهنا", "ذاك", "تلك", "تيك", "ذلك", "هنا", "هنالك", "هؤلاء", "اولئك", "هذان", "هتان", "وهذا", "وهذه", "وهذان", "وهاتان", "وهؤلاء", "فهذا", "فهذه", "فهذان", "فهاتان", "فهؤلاء", "لهذا", "لهذه", "لهذين", "لهاتين", "لهؤلاء", "بهذا", "بهذه", "بهذين", "بهاتين", "بهؤلاء", "كهذا", "كهذه", "كهذان", "كهاتان", "كهؤلاء", "وذلك", "وتلك", "فذلك", "فتلك", "لذلك", "لتلك", "بذلك", "بتلك", "كذلك", "كتلك", "ذلكما", "ذلكم", "ذلكن", "تلكما", "تلكم", "تلكن"]),
#     ("mawsoola", ["الذي", "التي", "الذين", "اللاتي", "اللائي", "من", "ما", "ذا", "والذي", "والتي","واللذان","واللتان","والذين","فالذي","فالتي","فاللذان","فاللتان","فالذين","للذي","للتي","لللذين","لللتين","للذين","بالذي","بالتي","باللذين","باللتين","بالذين","كالذي","كالتي","كاللذين","كاللتين","كالذين"]),
#     ("nasikha", ["إن", "أن", "كأن", "لكن", "ليت", "لعل", "لا", "إنما", "أنما", "ليتما", "كأنما","لعلما", "لكنما"]),
#     ("ism_feal", ["آمين", "حي", "هيا", "هيك", "هيت", "هلم الى", "هلم كذا", "هاؤم", "صه", "إيه", "مه", "رويدا", "رويدك", "بله", "هاء", "هاك", "هاكم", "دونك", "حس", "تيد", "هيهل", "هيهلك", "هيهلا", "حدياك", "بس", "النجاءك", "إيها", "فداء", "قدك", "قطك", "كذاك", "هداديك", "لديك", "عندك", "ويها", "ويه", "وراءك", "إليك", "عن", "إلي", "عليك", "مكانك", "أمامك", "حذار", "نزال", "هيهات", "بطآن", "بطئان", "شتان", "سرعان", "وشكان", "دهدريين", "قد", "حسب", "حسبك", "بجل", "أف", "وي", "ويك", "واه", "واها", "آه", "آها", "أواه", "أوه", "قط", "بخ", "زه", "أخ"]),
#     ("atef", ["و", "ف", "ثم", "حتى", "او", "ام", "بل", "لكن", "لا"]),
#     ("dameer", ["انا","نحن","انت","انت","انتما","انتم","انتن","هو","هي","هما","هم","هن","اياي","ايانا","اياك","اياك","اياكما","اياكم","اياكن","اياه","اياها","اياهما","اياهن","ت", "نا", "ن", "ا", "وا", "ي","كم", "ه", "ك", "ي", "نا"]),
#     ("tharf_mabni", ["حيث","منذ","قط","الان","غدا","الليلة","ثم","أيان","هناك","هنالك","ثة","اذ","مذ","لدى"]),
#     ("nafi", ["ما","لا","إن","لم","لما","لن","ليس","لات","غير"]),
#     ("nasb", ["أن","لن","إذن","كي","اللام","لام","حتى","فاء","واو","أو"]),
#     ("keniah", ["كم","كأين","كائن","كأي","كذا","كيت","ذيت","بضع"]),
#     ("istidrak", ["لكن","بل","بيد ان","إلا ان","غير ان","على الرغم من","على أية حال","علما أن","لذلك","على أن","مع ذلك"]),
#     ("al_gaebah", ["لغايه","لهدف","لأجل","وصولا الى","من اجل","نتيجه ل","لهذا","كي","رغبة في","على هذا","وعليه"]),
#     ("idafa", ["بالاضافة الى","قس على ذلك","الى جانب ذلك","كما","وأيضا","كذلك","فضلا عن"]),
#     ("taakeed", ["كلا","كلتا","جميع","عين","نفس","كافة","عامه","قد","أن","كل","أجمع","جمعاء","أجمعون","جمع","إن","ل","ن","هلا"]),
#     ("tafseel", ["أما","إما","الواو","ثم","إذن","غير أن","أي","الفاء","لا سيما","خصوصا","بخاصة","بل","مثل","أعني","أقصد","منها","من ذلك"]),
#     ("tafseer_w_taaleel", ["أي","الفاء","ل","فقد","لأن","بسبب","راجع الى","لكي","لأجل ذلك","بناء على","كي","لأن","لسبب","نظرا لـ","لهذا","اذ"]),
#     ("fujaeah", ["اذا","اذ","فاذا","واذا"]),
#     ("tazamon", ["بينما","تزامنا","حينها","ساعتها","تزامنا مع","بينا","لما","اثناء","خلال","مع"]),
#     ("istithnaa", ["الا","غير","سوى","خلا","عدا","حاشا","ليس"])
# ]

# # ربط رمز المجموعة بالتسمية العربية
# group_label_ar = {
#     'jar': 'حرف جر',
#     'al_jawab': 'أداة جواب',
#     'istifham': 'أداة استفهام',
#     'jazm': 'أدوات الجزم',
#     'shart': 'أداة شرط',
#     'nidaa': 'أداة نداء',
#     'ishara': 'أداة إشارة',
#     'mawsoola': 'أداة موصولة',
#     'nasikha': 'أداة ناسخة',
#     'ism_feal': 'أسماء/أفعال',
#     'atef': 'أداة عطف',
#     'dameer': 'ضمير',
#     'tharf_mabni': 'ظرف مبني',
#     'nafi': 'أداة نفي',
#     'nasb': 'أداة نصب',
#     'keniah': 'كناية/كمية',
#     'istidrak': 'استدراك',
#     'al_gaebah': 'غاية/سبب',
#     'idafa': 'إضافة/حال',
#     'taakeed': 'أداة تأكيد',
#     'tafseel': 'أداة تفصيل',
#     'tafseer_w_taaleel': 'تفسير/تعليل',
#     'fujaeah': 'أداة فجاءة',
#     'tazamon': 'تزامن/زمن',
#     'istithnaa': 'استثناء'
# }

# # بناء خريطة البحث العكسية (من الكلمة إلى رمز المجموعة)
# word_to_group = {}
# for grp_name, words in groups:
#     for w in words:
#         word_to_group[w] = grp_name

# # 2. قائمة التركيبات المراد تصنيفها (COMBINATIONS_TEXT)
# # ==============================================================================

# COMBINATIONS_TEXT = '''
# ءء ءب ءت ءث ءج ءح ءخ ءد ءذ ءر ءز ءس ءش ءص ءض ءع ءغ ءف ءق ءك ءل ءم ءن ءه ءو ءي ءا ءط ءظ
# بء بب بت بث بج بح بخ بد بذ بر بز بس بش بص بض بع بغ بف بق بك بل بم بن به بو بي با بط بظ
# تء تب تت تث تج تح تخ تد تذ تر تز تس تش تص تض تع تغ تف تق تك تل تم تن ته تو تي تا تط تظ
# ثء ثب ثت ثث ثج ثح ثخ ثد ثذ ثر ثز ثس ثش ثص ثض ثع ثغ ثف ثق ثك ثل ثم ثن ثه ثو ثي ثا ثط ثظ
# جء جب جت جث جج جح جخ جد جذ جر جز جس جش جص جض جع جغ جف جق جك جل جم جن جه جو جي جا جط جظ
# حء حب حت حث حج حح حخ حد حذ حر حز حس حش حص حض حع حغ حف حق حك حل حم حن حه حو حي حا حط حظ
# خء خب خت خث خج خح خخ خد خذ خر خز خس خش خص خض خع خغ خف خق خك خل خم خن خه خو خي خا خط خظ
# دء دب دت دث دج دح دخ دد دذ در دز دس دش دص دض دع دغ دف دق دك دل دم دن ده دو دي دا دط دظ
# ذء ذب ذت ذث ذج ذح ذخ ذد ذذ ذر ذز ذس ذش ذص ذض ذع ذغ ذف ذق ذك ذل ذم ذن ذه ذو ذي ذا ذط ذظ
# رء رب رت رث رج رح رخ رد رذ رر رز رس رش رص رض رع رغ رف رق رك رل رم رن ره رو ري را رط رظ
# زء زب زت زث زج زح زخ زد زذ زر زز زس زش زص زض زع زغ زف زق زك زل زم زن زه زو زي زا زط زظ
# سء سب ست سث سج سح سخ سد سذ سر سز سس سش سص سض سع سغ سف سق سك سل سم سن سه سو سي سا سط سظ
# شء شب شت شث شج شح شخ شد شذ شر شز شس شش شص شض شع شغ شف شق شك شل شم شن شه شو شي شا شط شظ
# صء صب صت صث صج صح صخ صد صذ صر صز صس صش صص صض صع صغ صف صق صك صل صم صن صه صو صي صا صط صظ
# ضء ضب ضت ضث ضج ضح ضخ ضد ضذ ضر ضز ضس ضش ضص ضض ضع ضغ ضف ضق ضك ضل ضم ضن ضه ضو ضي ضا ضط ضظ
# عء عب عت عث عج عح عخ عد عذ عر عز عس عش عص عض عع عغ عف عق عك عل عم عن عه عو عي عا عط عظ
# غء غب غت غث غج غح غخ غد غذ غر غز غس غش غص غض غع غغ غف غق غك غل غم غن غه غو غي غا غط غظ
# فء فب فت فث فج فح فخ فد فذ فر فز فس فش فص فض فع فغ فف فق فك فل فم فن فه فو في فا فط فظ
# قء قب قت قث قج قح قخ قد قذ قر قز قس قش قص قض قع قغ قف قق قك قل قم قن قه قو قي قا قط قظ
# كء كب كت كث كج كح كخ كد كذ كر كز كس كش كص كض كع كغ كف كق كك كل كم كن كه كو كي كا كط كظ
# لء لب لت لث لج لح لخ لد لذ لر لز لس لش لص لض لع لغ لف لق لك لل لم لن له لو لي لا لط لظ
# مء مب مت مث مج مح مخ مد مذ مر مز مس مش مص مض مع مغ مف مق مك مل مم من مه مو مي ما مط مظ
# نء نب نت نث نج نح نخ ند نذ نر نز نس نش نص نض نع نغ نف نق نك نل نم نن نه نو ني نا نط نظ
# هء هب هت هث هج هح هخ هد هذ هر هز هس هش هص هض هع هغ هف هق هك هل هم هن هه هو هي ها هط هظ
# وء وب وت وث وج وح وخ ود وذ ور وز وس وش وص وض وع وغ وف وق وك ول وم ون وه وو وي وا وط وظ
# يء يب يت يث يج يح يخ يد يذ ير يز يس يش يص يض يع يغ يف يق يك يل يم ين يه يو يي يا يط يظ
# اء اب ات اث اج اح اخ اد اذ ار از اس اش اص اض اع اغ اف اق اك ال ام ان اه او اي اا اط اظ
# طء طب طت طث طج طح طخ طد طذ طر طز طس طش طص طض طع طغ طف طق طك طل طم طن طه طو طي طا طط طظ
# ظء ظب ظت ظث ظج ظح ظخ ظد ظذ ظر ظز ظس ظش ظص ظض ظع ظغ ظف ظق ظك ظل ظم ظن ظه ظو ظي ظا ظط ظظ
# '''

# # 3. الدوال الرئيسية
# # ==============================================================================

# def parse_combinations(text: str):
#     """تقسيم نص التركيبات حسب المسافات البيضاء وتنظيف القائمة."""
#     # split by any whitespace and remove empties; normalize
#     items = [t.strip() for t in text.split() if t.strip()]
#     return items


# def classify_and_export(combinations):
#     """تصنيف كل تركيبة باستخدام word_to_group وتصدير ملف Excel."""
#     rows = []
#     for comb in combinations:
#         # البحث عن رمز المجموعة
#         grp_code = word_to_group.get(comb)

#         if grp_code:
#             # إذا وجدت، الحصول على التسمية العربية
#             cls_ar = group_label_ar.get(grp_code, grp_code)
#             meaning = 'نعم'  # يدل على أنها صُنفت
#         else:
#             # إذا لم توجد، تكون غير مصنفة
#             cls_ar = 'ليس له تصنيف'
#             meaning = 'لا'

#         rows.append({'combination': comb, 'classification': cls_ar, 'meaning': meaning})

#     df = pd.DataFrame(rows)

#     # تجهيز مسار الإخراج
#     # المجلد سيكون "data" في نفس مستوى ملف البايثون
#     out_dir = Path(__file__).resolve().parent / 'data'
#     out_dir.mkdir(parents=True, exist_ok=True)
#     out_path = out_dir / 'classified_combinations001.xlsx'

#     # تصدير إلى Excel
#     df.to_excel(out_path, index=False, engine='openpyxl')
#     print(f"✅ تم تصدير {len(df)} صفًا إلى: {out_path}")


#End